<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆ - ï½—ï½—ï½—ãƒ¬ãƒ</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Kosugi+Maru&family=Fredoka:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
    <link rel="stylesheet" href="reset.css" />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <!-- App Header -->
    <header class="app-header">
      <button class="back-btn" onclick="window.location.href='index.html'">
        <span class="material-icons">home</span>
      </button>
      <div class="header-actions">
        <button class="menu-toggle" onclick="toggleSideNav()">
          <div class="hamburger-line"></div>
        </button>
      </div>
    </header>

    <!-- Side Navigation (PC) -->
    <nav class="side-nav" id="sideNav">
      <div class="side-nav-header">
        <div class="nav-header-content">
          <h2>ï½—ï½—ï½—ãƒ¬ãƒ</h2>
          <p>ãŠç¬‘ã„ãƒ©ã‚¤ãƒ–ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆ</p>
        </div>
        <button class="nav-close-btn" onclick="toggleSideNav()">
          <span class="material-icons">close</span>
        </button>
      </div>
      <div class="side-nav-menu">
        <a href="index.html" class="side-nav-item">
          <span class="material-icons">home</span>
          ãƒ›ãƒ¼ãƒ 
        </a>
        <a href="account.html" class="side-nav-item">
          <span class="material-icons">account_circle</span>
          ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ
        </a>
        <a href="live-detail.html" class="side-nav-item">
          <span class="material-icons">people</span>
          å‡ºæ¼”è€…ç®¡ç†
        </a>
        <a href="results.html" class="side-nav-item">
          <span class="material-icons">analytics</span>
          é›†è¨ˆçµæœ
        </a>
        <a href="settings.html" class="side-nav-item">
          <span class="material-icons">settings</span>
          è¨­å®š
        </a>
        <a href="#" class="side-nav-item" onclick="handleLogout()">
          <span class="material-icons">logout</span>
          ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ
        </a>
      </div>
    </nav>

    <!-- Navigation Overlay -->
    <div class="nav-overlay" id="navOverlay" onclick="toggleSideNav()"></div>

    <div class="app">
      <div class="container main-content" id="mainContent">
        <div class="logo-header">
          <h1>ï½—ï½—ï½—ãƒ¬ãƒ</h1>
          <p>ãŠç¬‘ã„ãƒ©ã‚¤ãƒ–ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆ</p>
        </div>

        <div class="header">
          <h1 id="surveyTitle">ã‚µãƒ³ãƒ—ãƒ«ãƒ©ã‚¤ãƒ–ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆ</h1>
        </div>

        <div class="live-info-card">
          <h2 id="surveyLiveName">ã‚µãƒ³ãƒ—ãƒ«ãƒ©ã‚¤ãƒ–</h2>
          <p>ğŸ“… 2024å¹´3æœˆ15æ—¥ 19:00é–‹æ¼”</p>
          <p>ã”å‚åŠ ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ï¼å„èŠ¸äººã•ã‚“ã®è©•ä¾¡ã¨ã‚³ãƒ¡ãƒ³ãƒˆã‚’ãŠèã‹ã›ãã ã•ã„ã€‚</p>
        </div>

        <div class="current-performer-info" id="currentPerformerInfo">
          <div class="performer-badge">ç¾åœ¨è©•ä¾¡ä¸­</div>
          <h3>ã‚µãƒ³ãƒ—ãƒ«èŠ¸äººA</h3>
          <p>ã‚³ãƒ³ãƒˆãƒ»æ¼«æ‰</p>
        </div>

        <div class="survey-form" id="surveyForm">
          <div class="rating-section">
            <h3>ã“ã®èŠ¸äººã•ã‚“ã®è©•ä¾¡ã‚’ãŠèã‹ã›ãã ã•ã„</h3>
            <div class="star-rating" id="starRating">
              <button class="star" data-rating="1">â­</button>
              <button class="star" data-rating="2">â­</button>
              <button class="star" data-rating="3">â­</button>
              <button class="star" data-rating="4">â­</button>
              <button class="star" data-rating="5">â­</button>
            </div>
            <p class="rating-text" id="ratingText">è©•ä¾¡ã‚’é¸æŠã—ã¦ãã ã•ã„</p>
          </div>

          <div class="comment-section">
            <h3>ã‚³ãƒ¡ãƒ³ãƒˆï¼ˆä»»æ„ï¼‰</h3>
            <textarea id="comment" placeholder="é¢ç™½ã‹ã£ãŸç‚¹ã€å°è±¡ã«æ®‹ã£ãŸãƒã‚¿ãªã©ã€è‡ªç”±ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’ãŠèã‹ã›ãã ã•ã„ã€‚"></textarea>
            <div class="char-count"><span id="charCount">0</span>/200æ–‡å­—</div>
          </div>

          <button class="btn-primary full-width" onclick="submitRating()" id="submitBtn" disabled>è©•ä¾¡ã‚’é€ä¿¡</button>
        </div>

        <!-- é€ä¿¡å®Œäº†è¡¨ç¤º -->
        <div class="survey-success" id="surveySuccess" style="display: none">
          <div class="success-icon">
            <span class="material-icons">check_circle</span>
          </div>
          <h3>è©•ä¾¡ã‚’é€ä¿¡ã—ã¾ã—ãŸï¼</h3>
          <p>ã”å”åŠ›ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€‚</p>
          <div class="next-info">
            <p>æ¬¡ã®èŠ¸äººã•ã‚“ã®è©•ä¾¡ã‚’ãŠå¾…ã¡ãã ã•ã„...</p>
            <button class="btn-secondary-purple" onclick="checkForNextPerformer()">æ›´æ–°ã—ã¦ç¢ºèª</button>
          </div>
        </div>

        <!-- å…¨ã¦å®Œäº†è¡¨ç¤º -->
        <div class="survey-complete" id="surveyComplete" style="display: none">
          <div class="complete-icon">ğŸ‰</div>
          <h3>ã™ã¹ã¦ã®è©•ä¾¡ãŒå®Œäº†ã—ã¾ã—ãŸï¼</h3>
          <p>æœ¬æ—¥ã¯ãŠç¬‘ã„ãƒ©ã‚¤ãƒ–ã«ã”å‚åŠ ã„ãŸã ãã€ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€‚</p>
          <p>çš†æ§˜ã®è©•ä¾¡ãŒèŠ¸äººã•ã‚“ã®ä»Šå¾Œã®æ´»å‹•ã«å½¹ç«‹ã¦ã‚‰ã‚Œã¾ã™ã€‚</p>
        </div>
      </div>
    </div>

    <!-- è©•ä¾¡æ¸ˆã¿è¡¨ç¤º -->
    <div class="already-rated" id="alreadyRated" style="display: none">
      <div class="info-icon">
        <span class="material-icons">info</span>
      </div>
      <h3>ã“ã®èŠ¸äººã•ã‚“ã¯æ—¢ã«è©•ä¾¡æ¸ˆã¿ã§ã™</h3>
      <p>ã”å”åŠ›ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€‚</p>
      <button class="btn-secondary-purple" onclick="checkForNextPerformer()">æ¬¡ã®èŠ¸äººã•ã‚“ã‚’ãƒã‚§ãƒƒã‚¯</button>
    </div>

    <!-- Floating Menu -->
    <div class="fab-menu" id="fabMenu">
      <div class="fab-backdrop" onclick="toggleFabMenu()"></div>
      <div class="fab-options">
        <a href="create-survey.html" class="fab-option">
          <span class="material-icons">quiz</span>
          <span class="fab-label">ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆä½œæˆ</span>
        </a>
        <a href="create-live.html" class="fab-option">
          <span class="material-icons">event</span>
          <span class="fab-label">ãƒ©ã‚¤ãƒ–ä½œæˆ</span>
        </a>
      </div>
      <button class="fab" onclick="toggleFabMenu()">
        <span class="material-icons">add</span>
      </button>
    </div>

    <script src="survey-script.js"></script>
    <script src="navigation.js"></script>
    <script>
      // Header scroll functionality
      document.addEventListener("DOMContentLoaded", function () {
        let lastScrollTop = 0;
        let isScrolling = false;
        const header = document.querySelector(".logo-header");
        const scrollThreshold = 5; // Minimum scroll distance to trigger

        if (!header) {
          console.error("Header element not found");
          return;
        }

        function handleScroll() {
          let scrollTop = window.pageYOffset || document.documentElement.scrollTop;
          let scrollDifference = Math.abs(scrollTop - lastScrollTop);

          // Only react if scroll difference is significant enough
          if (scrollDifference < scrollThreshold) {
            return;
          }

          if (scrollTop > 100) {
            if (scrollTop < lastScrollTop - scrollThreshold) {
              // Scrolling up significantly - show header
              header.classList.add("show");
            } else if (scrollTop > lastScrollTop + scrollThreshold) {
              // Scrolling down significantly - hide header
              header.classList.remove("show");
            }
          } else {
            // At top of page - hide header
            header.classList.remove("show");
          }

          lastScrollTop = scrollTop <= 0 ? 0 : scrollTop;
        }

        function throttle(func, wait) {
          let timeout;
          return function executedFunction(...args) {
            const later = () => {
              clearTimeout(timeout);
              func(...args);
            };
            clearTimeout(timeout);
            timeout = setTimeout(later, wait);
          };
        }

        window.addEventListener("scroll", throttle(handleScroll, 100), { passive: true });
      });

      function toggleFabMenu() {
        const fabMenu = document.getElementById('fabMenu');
        fabMenu.classList.toggle('open');
      }
    </script>
  </body>
</html>
